let i=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];let t={1:{t:'Snare Trap',i:`<b>Narrowing Down the Wordlist:</b> Begin by making a series of guesses from the available 5-letter word list. Each guess should help filter down the word list.<br>
    <b>Letter Grouping Restriction:</b> No subsequent guesses can contain two or more letters that appear together in a previous guess.<br>
    <ul><li><i>Example:</i> If your first guess is "Water", a later guess like "Wrist" is not allowed since the letters "W", "R", and "T" are grouped together in "Water."</li></ul>
    <b>Word Selection:</b> Once the word list has been narrowed down to 100 words or fewer, the final word will be chosen.<br>
    <b>Guess Feedback:</b> After the word is chosen:<br>
    <ul>
        <li>Green letters indicate the correct letter in the correct position.</li>
        <li>Yellow letters indicate the correct letter in the wrong position.</li>
    </ul>`},2:{t:'Elusive Goose',i:`<b>Guess:</b> Start by guessing a 5-letter word.<br>
    After each guess:<br>
    <ul>
        <li><b>Green letters</b> indicate the correct letter in the correct position.</li>
        <li><b>Yellow letters</b> indicate the correct letter in the wrong position.</li>
    </ul>
    <b>Mystery Word Changes:</b><br>
    <ul>
        <li>Every three guesses, the mystery word will change.</li>
        <li>The new word will always include any green letters that have been guessed correctly so far.</li>
    </ul>`}};let a,r,l,o,c,d,u,b,f,s,h;$(document).ready(function(){$('#mode-menu').addClass('show');e(2)});$(document).on('click','#mode-menu .mode-btn',function(){e($(this).data('mode'));$('#mode-menu').removeClass('show')});$(document).on('click','.active-tile',function(){if(!$(this).hasClass('starter-tile')){$('.selected-tile').removeClass('selected-tile');$(this).addClass('selected-tile')}});$(document).on('click','.editable-tile',function(){$('.selected-tile').removeClass('selected-tile');$(this).addClass('selected-tile')});$(document).on('click','.menu .close-btn',function(){$(this).closest('.menu').removeClass('show')});$(document).on('click','#mode-btn',function(){$('.menu').removeClass('show');$('#mode-menu').addClass('show')});$(document).on('click','#reset-dialog .reset-cancel-btn',function(){$('#reset-dialog').removeClass('show')});$(document).on('click','#reset-dialog .reset-confirm-btn',function(){$('#reset-dialog').removeClass('show');n()});$(document).on('click','#lose-dialog .giveup-cancel-btn',function(){$('#lose-dialog').removeClass('show')});$(document).on('click','#lose-dialog .giveup-confirm-btn',function(){if(h===0){h=-1;$('#lose-dialog').removeClass('show');y()}});$(document).on('click','#player-dialog .player-submit-btn',async function(){let e=$('#player-input').val();if(e!==''){$('#player-dialog').removeClass('show');await p();o.Players.push({l:{o:o.Players.length.toString(),t:e.toString()},u:{$:[1,1.5].includes(f)?b.length:0},h:{g:d.m.toUpperCase(),k:f===2?b.length:0}});o.p=o.Players.filter(e=>e.u.$>0).sort((e,t)=>e.u.$-t.u.$).map(e=>({l:e.l,$:e.u.$})).slice(0,10);o.v=o.Players.filter(e=>e.h.k>0).sort((e,t)=>e.h.k-t.h.k).map(e=>({l:e.l,g:e.h.g,k:e.h.k})).slice(0,10);v();$('#scoreboard').addClass('show');O()}else{}y()});$(document).on('click','#player-dialog .player-skip-btn',function(){$('#player-dialog').removeClass('show');y(1)});$(document).on('click','#scoreboard-btn',async function(){await p();$('.menu').removeClass('show');$('#scoreboard').addClass('show')});$(document).on('click','.fa-question-circle',function(){$('.menu').removeClass('show');$('#instructions-dialog').addClass('show')});$(document).on('click','.keyboard-key',function(){let t=$(this).data('key');switch(t){case'↵':if($('.filled-tile').length>0&&$('.filled-tile').length%5===0&&h===0)j($('.filled-tile').last().closest('.group').find('.tile'));break;case'←':if(h===0){let e=$('.selected-tile').length>0?$('.selected-tile').first():$('.editable-tile').last();e.data('letter','').text('').removeClass('editable-tile').removeClass('selected-tile').addClass('empty-tile')}break;case'reset':$('.menu').removeClass('show');$('#reset-dialog').addClass('show');break;case'giveup':$('.menu').removeClass('show');$('#lose-dialog').addClass('show');break;default:if(($('.editable-tile').length===0||$('.empty-tile').length%5!==0)&&h===0){let e=$('.selected-tile').length>0?$('.selected-tile').first():$('.empty-tile').first();e.data('letter',t).text(t).removeClass('empty-tile').removeClass('selected-tile').addClass('filled-tile').addClass('editable-tile')}break}});$(document).on('keyup',function(e){let t=e.keyCode||e.which;if(t===8||t===13||t>=65&&t<=90){switch(t){case 13:$('.keyboard-key[data-key="↵"]').click();break;case 8:$('.keyboard-key[data-key="←"]').click();break;default:$(`.keyboard-key[data-key="${i[t-65]}"]`).click();break}}});async function n(){$('.board').remove();$('.keyboard-key').removeClass('incorrect-key').removeClass('present-key').removeClass('correct-key');c=[];u=[];b=[];h=0;await w();a=f===1?l:r;s=a.length;switch(f){case 1:$('.bar').css('width','100%');$('.bar-marker').css('left',`${100/s*100}%`).css('opacity',1);$('.progress-msg').text(`${s} / ${s} words`);break;case 2:d=G();c.push(d);$('.bar').css('width','0');$('.bar-marker').css('opacity',0);$('.progress-msg').text('');break;default:break}m()}async function e(e){f=e;await n();a=f===1?l:r;s=a.length;$('#mode-btn').text(t[f].t).css('opacity',1);$('#instructions-dialog h3').html(t[f].t);$('#instructions-dialog p').html(t[f].i)}function y(){if(c.length>0&&b.length>0){$('.answer-group').each(function(e){let t=c[e].m.split('');$(this).find('.tile').each(function(e){$(this).data('letter',t[e]).text(t[e])})});$('.answer-group').css('display','grid')}}async function w(){r=await g('./wordlist.txt');l=await g('./wordlist-all.txt')}async function g(e){return fetch(e).then(e=>{return e.text()}).then(e=>{return e.split('\r\n').map(e=>({m:e,O:M(e),j:0}))})["catch"](e=>{console.error("Error reading file:",e)})}function m(){$('.board-container').append('<div class="board"></div>');k($('.board').last());let e=document.querySelectorAll('.board');e[e.length-1].scrollIntoView({behavior:'smooth'})}function k(e){let t=f===2?3:6;for(let i=0;i<t;i++){let t=$(`<div class="group"></div>`);for(let e=0;e<5;e++)t.append(`<div class="tile empty-tile ${i===0?'active-tile':''}" data-index="${e+1}"></div>`);e.append(t)}if(f===1&&b.length===0){let e=i[Math.floor(Math.random()*25)];$('.active-tile').first().data('letter',e).text(e).removeClass('empty-tile').addClass('filled-tile').addClass('starter-tile')}else{let t=$(`<div class="group answer-group"></div>`);for(let e=0;e<5;e++)t.append(`<div class="tile" data-index="${e+1}"></div>`);e.append(t)}}function p(){return new Promise(t=>{$.ajax({type:"GET",url:"https://prod-56.westus.logic.azure.com:443/workflows/7534300353cb48ad892f6741046aeab8/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=JS-U_mvyGe_-PXwesvCPE7DA0oASww0h6h7D1RXM47Q",W:function(e){o=JSON.parse(e);v();t()}})})}function v(){$('#st-scoreboard table tbody').empty();for(let r in o.p){let e=o.p[r];let t=e.l;let i=e.$;$('#st-scoreboard table tbody').append(`<tr><td>${t.t}</td><td style="text-align:center;">${i}</td></tr>`)}$('#eg-scoreboard table tbody').empty();for(let l in o.v){let e=o.v[l];let t=e.l;let i=e.g;let r=e.k;$('#eg-scoreboard table tbody').append(`<tr><td>${t.t}</td><td>${i}</td><td style="text-align:center;">${r}</td></tr>`)}}function O(){let e='https://prod-175.westus.logic.azure.com:443/workflows/da7be3f7e0374a6aa1c200d4ae6730f7/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=dmIrVanj-WdaSVYRRrJnyqBIXafgN1aBxQUrMCU2Lag';let t=new XMLHttpRequest;t.open("POST",e,true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(this.readyState===4){t.onreadystatechange=null;if(this.status===202){let e=JSON.parse(this.response);T('Scoreboard updated!')}}};t.send(JSON.stringify(o))}function j(e){let t=[];e.each(function(){t.push($(this).data('letter'))});let i=t.join('');if(u.includes(i)){T('Word was already guessed!');e.each(function(){$(this).addClass('editable-tile')})}else if(f!==1&&l.find(e=>e.m===i)===undefined){T('Word is not in the wordlist!');e.each(function(){$(this).addClass('editable-tile')})}else if(f===1&&a.find(e=>e.m===i)===undefined){T('Word is not in the wordlist!');e.each(function(){if(!$(this).hasClass('starter-tile'))$(this).addClass('editable-tile')})}else{e.each(function(){$(this).removeClass('editable-tile').addClass('submitted-tile')});W(e,i);$('.active-tile').removeClass('active-tile');$('.empty-tile').slice(0,5).each(function(){$(this).addClass('active-tile')})}}function W(e,t){u.push(t);b.push(t);switch(f){case 1:S(t);break;case 1.5:case 2:x(e,t);break;default:break}}function S(t){a=a.map(e=>({...e,j:N(e,t)})).filter(e=>e.j<2);$('.progress-msg').text(`${a.length} / ${s} words`);if(a.length<=100){d=G();c.push(d);T(`A word has been chosen!`);f=1.5;$('.bar-marker').css('opacity',0);$('.progress-msg').text('')}else $('.bar').css('width',`${a.length/s*100}%`);if($('.empty-tile').length===0)m()}function x(r,e){let l=d.m.split('').map(e=>({S:e,G:false}));let o=e.split('').map((e,t)=>({index:t,S:e,G:false}));for(let i=0;i<l.length;i++){let t=o.find((e,t)=>e.S===l[i].S&&!e.G&&t===i);if(t!==undefined){let e=$(`.keyboard-key[data-key="${t.S}"]`);r.eq(t.index).addClass('correct-tile');e.removeClass('present-key').addClass('correct-key');t.G=true;l[i].G=true}}let s=l.filter(e=>!e.G);for(let i=0;i<s.length;i++){let t=o.find(e=>e.S===s[i].S&&!e.G);if(t!==undefined){let e=$(`.keyboard-key[data-key="${t.S}"]`);r.eq(t.index).addClass('present-tile');if(!e.hasClass('correct-key'))e.addClass('present-key');t.G=true}}let i=o.filter(e=>!e.G);for(let t=0;t<i.length;t++){let e=$(`.keyboard-key[data-key="${i[t].S}"]`);r.eq(i[t].index).addClass('incorrect-tile');if(!e.hasClass('correct-key')&&!e.hasClass('present-key'))e.addClass('incorrect-key')}let t={};$('.submitted-tile').last().closest('.group').find('.correct-tile').each(function(){t[$(this).data('index')]=$(this).data('letter')});let n={};$('.submitted-tile').last().closest('.group').find('.present-tile').each(function(){n[$(this).data('index')]=$(this).data('letter')});if(e===d.m){h=1;T(`You won after ${b.length} guesses!`);$('#player-dialog').addClass('show');$('.bar').css('width',`${(Object.keys(n).length+Object.keys(t).length*2)/10*100}%`)}else if($('.empty-tile').length<30&&$('.empty-tile').length%15===0&&f===2){a=a.map(e=>({...e,j:N(e,Object.values(t).join(''))})).filter(e=>e.j>=Object.keys(t).length&&e!==d.m);d=G();c.push(d);u=[];T(`The answer changed!`);$('.keyboard-key').removeClass('incorrect-key').removeClass('present-key');$('.correct-key').removeClass('correct-key').addClass('present-key');if($('.empty-tile').length===0){$('.bar').css('width',`${Object.keys(t).length>0?Object.keys(t).length/10*100:0}%`);m()}else $('.bar').css('width',`${(Object.keys(n).length+Object.keys(t).length*2)/10*100}%`)}else if(f===1.5&&$('.empty-tile').length===0){m();$('.bar').css('width',`${(Object.keys(n).length+Object.keys(t).length*2)/10*100}%`)}else $('.bar').css('width',`${(Object.keys(n).length+Object.keys(t).length*2)/10*100}%`)}function G(){let e=Math.floor(Math.random()*a.length);return a[e]}function M(t){const i=new Map;for(let e of t){if(i.has(e))i.set(e,i.get(e)+1);else i.set(e,1)}return i}function N(e,t){const i=e.O;const r=M(t);let l=0;for(let e of i.keys()){if(r.has(e))l+=Math.min(i.get(e),r.get(e))}return l}function T(e){$('#toast-msg').text(e).addClass('show');setTimeout(function(){$('#toast-msg').removeClass('show')},3e3)}